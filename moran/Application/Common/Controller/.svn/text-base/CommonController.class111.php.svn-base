<?php /* Copyright (c) 2014-2016 http://www.corethink.cn All rights reserved.
-- mzphp æ··æ·†åŠ å¯†ï¼šhttps://git.oschina.net/mz/mzphp2
 */   namespace Common\Controller;use Think\Controller;class CommonController extends Controller{protected function display($¬='',$Å“='',$£ô©ú¿='',$°ØÌÙ³='',$ ¢Ò=''){if(!is_file($¬)){$šÕ=C('TMPL_FILE_DEPR');if('' ==$¬){$¬=CONTROLLER_NAME.$šÕ.ACTION_NAME;}elseif(false===strpos($¬,$šÕ)){$¬=CONTROLLER_NAME.$šÕ.$¬;}}else{$„âê³…=$¬;µú˜Äûâ¸–¼Êóè»ŞÑ­Ş‡ıœòëœĞßóà¡öÜ§ú¼‹Ø¶®›î™—¥›ü;™©ÊÔ¯¤°»û…øêîÒªØ³¡Ø€ı©†§ÎğÜ•èØâ¨—…ÔşÆ§ˆ£Š­ğ¶¨ö“‡ó;È—àš¶¡§â™ ‘’ŸğØé„é;}$Ì=array();$ËëÁå=C('CURRENT_THEME');şõÖÜ¦‚°ßÛÓÕÏø©ï±’‘´¡øüäÊÌÈş´˜úÂŸ™âİ¢­İšü¹Œ©Ç¢ï½‰±ĞÇÕÆƒºÃ…¦ÙÛ–¬ºãÚ¥î­;$’=C('CURRENT_DOMAIN');€¦øÂŸí­ÈÜª€¸ÊèÄÂ±Š® ´èµœ ÑŠäøÖ‘Â´‡¯×¯ÔØÊ¬ƒ;”º¦ß¿¯ÖÎğ­÷¶Èã¯õæÍ‡òŒ‰Óœ¼ÜùÓêÔî³;$¦=$this->view->get('is_builder');åÃ²²İåËù€òœØô°ììäå‘¬“ÂõÜšëèœËÛ©;if($ËëÁå){if(C('IS_WAP')){$óïü•€='./Theme/'.$ËëÁå.'/'.MODULE_NAME.'/';$ä='./Theme/'.$ËëÁå.'/'.MODULE_NAME.'/Wap/';$Ì['TMPL_PARSE_STRING']=C('TMPL_PARSE_STRING');if($¦){$€ì='./Theme/'.$ËëÁå.'/Home/Wap/Public';if(is_dir($€ì)){$Ì['HOME_PUBLIC_LAYOUT']=$€ì.'/layout.html';$Ì['HOME_PUBLIC_MODAL']=$€ì.'/modal.html';$Ì['TMPL_PARSE_STRING']['__HOME_IMG__']=$’.'/'.$€ì.'/img';$Ì['TMPL_PARSE_STRING']['__HOME_CSS__']=$’.'/'.$€ì.'/css';$Ì['TMPL_PARSE_STRING']['__HOME_JS__']=$’.'/'.$€ì.'/js';$Ì['TMPL_PARSE_STRING']['__HOME_LIBS__']=$’.'/'.$€ì.'/libs';if(MODULE_MARK==='Home'){$ş='./Theme/'.$ËëÁå.'/Home/Wap/Builder';if(is_dir($ş)){$Ì['LISTBUILDER_LAYOUT']=$ş.'/listbuilder.html';$Ì['FORMBUILDER_LAYOUT']=$ş.'/formbuilder.html';}if(is_dir('./Theme/' .$ËëÁå.'/User/Wap')){$Ì['USER_CENTER_SIDE']='./Theme/'.$ËëÁå.'/User/Wap/Index/side.html';if(is_dir('./Theme/'.$ËëÁå.'/User/Wap/Builder')){$Ì['USER_CENTER_FORM']='./Theme/'.$ËëÁå.'/User/Wap/Builder/form.html';$Ì['USER_CENTER_LIST']='./Theme/'.$ËëÁå.'/User/Wap/Builder/list.html';if('list' ===$¦){$¬=$Ì['USER_CENTER_LIST'];}if('form' ===$¦){$¬=$Ì['USER_CENTER_FORM'];}}}}if(MODULE_MARK==='Home'){$Ì['VIEW_PATH']=$ä;}else if(MODULE_MARK==='Admin' && MODULE_NAME!=='Admin'){if(is_dir($ä.'Admin/')){$Ì['VIEW_PATH']=$ä.'Admin/';}}$“Êı='./Theme/' .$ËëÁå.'/' .MODULE_NAME.'/Wap/Public';ôƒƒ€ì©;if(is_dir($“Êı)){$Ì['TMPL_PARSE_STRING']['__IMG__']=$’.'/'.$“Êı.'/img';$Ì['TMPL_PARSE_STRING']['__CSS__']=$’.'/'.$“Êı.'/css';$Ì['TMPL_PARSE_STRING']['__JS__']=$’.'/'.$“Êı.'/js';$Ì['TMPL_PARSE_STRING']['__LIBS__']=$’.'/'.$“Êı.'/libs';}}}else{if(!$„âê³…){$„âê³…='./Theme/' .$ËëÁå.'/'.MODULE_NAME.'/Wap/' .$¬.'.html';if(!is_file($„âê³…)&& is_dir($óïü•€)&& !defined('IS_ADDON')){$€ì='./Theme/'.$ËëÁå.'/Home/Public';if(is_dir($€ì)){$Ì['HOME_PUBLIC_LAYOUT']=$€ì.'/layout.html';$Ì['HOME_PUBLIC_MODAL']=$€ì.'/modal.html';$Ì['TMPL_PARSE_STRING']['__HOME_IMG__']=$’.'/'.$€ì.'/img';$Ì['TMPL_PARSE_STRING']['__HOME_CSS__']=$’.'/'.$€ì.'/css';$Ì['TMPL_PARSE_STRING']['__HOME_JS__']=$’.'/'.$€ì.'/js';$Ì['TMPL_PARSE_STRING']['__HOME_LIBS__']=$’.'/'.$€ì.'/libs';if(MODULE_MARK==='Home'){$ş='./Theme/'.$ËëÁå.'/Home/Builder';if(is_dir($ş)){$Ì['LISTBUILDER_LAYOUT']=$ş.'/listbuilder.html';$Ì['FORMBUILDER_LAYOUT']=$ş.'/formbuilder.html';}if(is_dir('./Theme/' .$ËëÁå.'/User')){$Ì['USER_CENTER_SIDE']='./Theme/'.$ËëÁå.'/User/Index/side.html';}}if(MODULE_MARK==='Home'){$Ì['VIEW_PATH']=$óïü•€;}else if(MODULE_MARK==='Admin' && MODULE_NAME!=='Admin'){if(is_dir($ä.'Admin/')){$Ì['VIEW_PATH']=$óïü•€.'Admin/';}}$“Êı='./Theme/' .$ËëÁå.'/' .MODULE_NAME.'/Public';if(is_dir($“Êı)){$Ì['TMPL_PARSE_STRING']['__IMG__']=$’.'/'.$“Êı.'/img';$Ì['TMPL_PARSE_STRING']['__CSS__']=$’.'/'.$“Êı.'/css';$Ì['TMPL_PARSE_STRING']['__JS__']=$’.'/'.$“Êı.'/js';$Ì['TMPL_PARSE_STRING']['__LIBS__']=$’.'/'.$“Êı.'/libs';}}}}}}}else{if(C('IS_WAP')){$óïü•€=APP_PATH.MODULE_NAME.'/View/';$ä=APP_PATH.MODULE_NAME.'/View/Wap/';$Ì['TMPL_PARSE_STRING']=C('TMPL_PARSE_STRING');if($¦){$€ì=APP_PATH.'/Home/View/Wap/Public';if(is_dir($€ì)){$Ì['HOME_PUBLIC_LAYOUT']=$€ì.'/layout.html';$Ì['HOME_PUBLIC_MODAL']=$€ì.'/modal.html';$Ì['TMPL_PARSE_STRING']['__HOME_IMG__']=$’.'/'.$€ì.'/img';$Ì['TMPL_PARSE_STRING']['__HOME_CSS__']=$’.'/'.$€ì.'/css';$Ì['TMPL_PARSE_STRING']['__HOME_JS__']=$’.'/'.$€ì.'/js';$Ì['TMPL_PARSE_STRING']['__HOME_LIBS__']=$’.'/'.$€ì.'/libs';if(MODULE_MARK==='Home'){$ş=APP_PATH.'/Home/View/Wap/Builder';if(is_dir($ş)){$Ì['LISTBUILDER_LAYOUT']=$ş.'/listbuilder.html';$Ì['FORMBUILDER_LAYOUT']=$ş.'/formbuilder.html';}if(is_dir(APP_PATH.'/User/View/Wap')){$Ì['USER_CENTER_SIDE']=APP_PATH.'User/View/Wap/Index/side.html';if(is_dir(APP_PATH.'/User/View/Wap/Builder')){$Ì['USER_CENTER_FORM']=APP_PATH.'User/View/Wap/Builder/form.html';$Ì['USER_CENTER_LIST']=APP_PATH.'User/View/Wap/Builder/list.html';if('list' ===$¦){$¬=$Ì['USER_CENTER_LIST'];}if('form' ===$¦){$¬=$Ì['USER_CENTER_FORM'];}}}}if(MODULE_MARK==='Home'){$Ì['VIEW_PATH']=$ä;}else if(MODULE_MARK==='Admin' && MODULE_NAME!=='Admin'){if(is_dir($ä.'Admin/')){$Ì['VIEW_PATH']=$ä.'Admin/';}}$“Êı=APP_PATH.MODULE_NAME.'/View/Wap/Public';Â„ª;if(is_dir($“Êı)){$Ì['TMPL_PARSE_STRING']['__IMG__']=$’.'/'.$“Êı.'/img';$Ì['TMPL_PARSE_STRING']['__CSS__']=$’.'/'.$“Êı.'/css';$Ì['TMPL_PARSE_STRING']['__JS__']=$’.'/'.$“Êı.'/js';$Ì['TMPL_PARSE_STRING']['__LIBS__']=$’.'/'.$“Êı.'/libs';}}}else{if(!$„âê³…){$„âê³…=APP_PATH.MODULE_NAME.'/View/Wap/' .$¬.'.html';if(!is_file($„âê³…)&& !defined('IS_ADDON')){$€ì=APP_PATH.'Home/View/Public';if(is_dir($€ì)){$Ì['HOME_PUBLIC_LAYOUT']=$€ì.'/layout.html';$Ì['HOME_PUBLIC_MODAL']=$€ì.'/modal.html';$Ì['TMPL_PARSE_STRING']['__HOME_IMG__']=$’.'/'.$€ì.'/img';$Ì['TMPL_PARSE_STRING']['__HOME_CSS__']=$’.'/'.$€ì.'/css';$Ì['TMPL_PARSE_STRING']['__HOME_JS__']=$’.'/'.$€ì.'/js';$Ì['TMPL_PARSE_STRING']['__HOME_LIBS__']=$’.'/'.$€ì.'/libs';if(MODULE_MARK==='Home'){$ş=APP_PATH.'Common/Builder';$Ì['LISTBUILDER_LAYOUT']=$ş.'/listbuilder.html';$Ì['FORMBUILDER_LAYOUT']=$ş.'/formbuilder.html';$Ì['USER_CENTER_SIDE']=APP_PATH.'User/View/Index/side.html';}if(MODULE_MARK==='Home'){$Ì['VIEW_PATH']=$óïü•€;}else if(MODULE_MARK==='Admin' && MODULE_NAME!=='Admin'){if(is_dir($ä.'Admin/')){$Ì['VIEW_PATH']=$óïü•€.'Admin/';}}}}}}}}C($Ì);„ÌÈıæÁºÍ¯É´œ¼¨ÃÚş–µ›˜÷ëØâ……¡ÑâìÛÜÕ’Ê×Î“¶¼‹Éïäé°˜§ï¢ğê¸™ä¥øÌ«ÏØè;$Îœåæ['status']=0x001;¡ÄÉ©Í;†§»ß½¿ÂĞıÒßëîäæ×ûá¿ ç‡í¸§Ë¼ƒ„ğÈì–Õ«ß“ñßÌ æèÏ;$ü‹ëÌ=array();Ë”·ªƒÑãÚ°ö¨·Ê†”³±É–;$Íó=D('Admin/Module')->where($Îœåæ)->getField('user_nav',true);foreach($Íó as $Ö¯ç=>$Ç){if($Ç){$Ç=json_decode($Ç,true);if($Ç['main']){$ü‹ëÌ=array_merge($ü‹ëÌ,$Ç['main']);}}}$this->assign('meta_keywords',C('WEB_SITE_KEYWORD'));Ìğ±„®íÓà°‡÷´Îîßõ¢™©’Ó÷÷üÂÚ…¹™;½;»—Òèè“úÁ;$this->assign('meta_description',C('WEB_SITE_DESCRIPTION'));¾’æï¤ª±ı¥°ÜÇ;$this->assign('_new_message',cookie('_new_message'));ö›åÊÑÜÙÅÖñ‚÷Œú;„¢°½éëçŒÁ¼µ¡Ûç½ˆÕö„œÓå¬Ù¬Ëô·‚Àâú¢Úó·û“·úñØâò¸ºá¯âû¹¿¬öï’ü‘ÂîÚñĞéÊë¯à;$this->assign('_user_auth',session('user_auth'));•š;$this->assign('_user_nav_main',$ü‹ëÌ);öš†¿ŞŸ½ÔÍ¯Â­ÛÈ–©‰ÆÃŒá²”°ºİÌôëÈÓßìÃÂ–í×Ì“ÓşğÕí¸¿ÙÚá¹ÒÀÃ¢;Šàë¹îô±üšˆÜí‘àÑô›Û;$this->assign('_user_center_side',C('USER_CENTER_SIDE'));$this->assign('_admin_public_layout',C('ADMIN_PUBLIC_LAYOUT'));×ÅÆ¥äİ·Òæ©ıá°Æßóê­ıäıùĞ¼ô³óïó´·¡Š”¾àÚ¾‘­ÌÍ¸Íö´¬;$this->assign('_home_public_layout',C('HOME_PUBLIC_LAYOUT'));Ë÷á”´;$this->assign('_home_public_modal',C('HOME_PUBLIC_MODAL'));ÏÄÄ;¼¨Ù©ˆá¢¦„ÈÌÒ²‹åü€üí‹äï¼¢˜äÎá²çµ¤±õÀšùÉ;$this->assign('_listbuilder_layout',C('LISTBUILDER_LAYOUT'));$this->assign('_formbuilder_layout',C('FORMBUILDER_LAYOUT'));¾–¼åñİ¹¥˜ğí÷Æä—å;ƒµ»‡ï…û Ëõøê‘˜•´óğĞÑ¹«ÛíâóŞ¸¿šıØÉ†µøïğŠ¼ïãÕí¦Ü±Ëò¡Æ©§…ß†Ü„¹ÑøË‡„¯—Î¦;$this->assign('_page_name',strtolower(MODULE_NAME.'_' .CONTROLLER_NAME.'_' .ACTION_NAME));if(IS_AJAX){if(is_file($this->view->parseTemplate($¬))){$ ŸŸÈ=$this->fetch($¬);}$this->success('æ•°æ®è·å–æˆåŠŸ','',array('data' =>$this->view->get(),'html' =>$ ŸŸÈ));}else{$this->view->display($¬);}}}